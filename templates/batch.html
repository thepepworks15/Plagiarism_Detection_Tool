{% extends "base.html" %}
{% block title %}Batch Processing - Plagiarism Detector{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <h2 class="fw-bold mb-4"><i class="fas fa-layer-group text-primary me-2"></i>Batch Document Comparison</h2>
            <p class="text-muted mb-4">Upload multiple documents to compare all of them against each other.</p>

            <form method="POST" enctype="multipart/form-data" id="batchForm">
                <div class="card p-4 mb-4">
                    <h5 class="mb-3"><i class="fas fa-file-upload me-2"></i>Upload Documents (2 or more)</h5>
                    <div class="upload-area" id="dropzone" onclick="document.getElementById('documents').click()">
                        <i class="fas fa-cloud-upload-alt fa-3x text-muted mb-3"></i>
                        <p class="text-muted mb-1">Drag & drop or click to upload multiple files</p>
                        <small class="text-muted">PDF, DOCX, or TXT (max 16MB each)</small>
                        <div class="mt-2" id="fileList"></div>
                    </div>
                    <input type="file" class="d-none" id="documents" name="documents"
                           accept=".pdf,.docx,.txt" multiple required>
                </div>

                <div class="text-center">
                    <button type="submit" class="btn btn-primary btn-lg px-5" id="submitBtn">
                        <i class="fas fa-cogs me-2"></i>Run Batch Analysis
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.getElementById('documents').addEventListener('change', function() {
        const list = document.getElementById('fileList');
        list.innerHTML = '';
        for (let f of this.files) {
            list.innerHTML += `<span class="badge bg-primary me-1 mb-1">${f.name}</span>`;
        }
    });

    const zone = document.getElementById('dropzone');
    const input = document.getElementById('documents');
    zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('dragover'); });
    zone.addEventListener('dragleave', () => zone.classList.remove('dragover'));
    zone.addEventListener('drop', e => {
        e.preventDefault();
        zone.classList.remove('dragover');
        if (e.dataTransfer.files.length) {
            input.files = e.dataTransfer.files;
            const list = document.getElementById('fileList');
            list.innerHTML = '';
            for (let f of e.dataTransfer.files) {
                list.innerHTML += `<span class="badge bg-primary me-1 mb-1">${f.name}</span>`;
            }
        }
    });

    document.getElementById('batchForm').addEventListener('submit', function() {
        const btn = document.getElementById('submitBtn');
        btn.disabled = true;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Processing batch... This may take a while';
    });
</script>
{% endblock %}
